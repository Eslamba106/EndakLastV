# ميزة تكرار القسم الفرعي

## الوصف
تم إضافة ميزة جديدة لتكرار الأقسام الفرعية مع إمكانية تغيير الاسم والوصف. هذه الميزة تسمح بنسخ قسم فرعي موجود مع جميع حقوله المرتبطة.

## الميزات

### 1. نسخ القسم الفرعي
- نسخ جميع بيانات القسم الفرعي (الاسم، الوصف، الصورة، الحالة)
- نسخ جميع الحقول المرتبطة بالقسم الفرعي
- إمكانية تغيير الاسم والوصف للقسم الجديد
- إمكانية رفع صورة جديدة أو نسخ الصورة الأصلية

### 2. واجهة المستخدم
- زر تكرار في صفحة الأقسام الفرعية
- زر تكرار في صفحة الأقسام الرئيسية (عند عرض الأقسام الفرعية)
- صفحة مخصصة لتكرار القسم الفرعي مع نموذج شامل

## كيفية الاستخدام

### من صفحة الأقسام الفرعية:
1. انتقل إلى صفحة الأقسام الفرعية
2. اضغط على زر التكرار (أيقونة النسخ) بجانب القسم الفرعي المطلوب
3. ستظهر صفحة تكرار القسم الفرعي
4. قم بتعديل الاسم والوصف حسب الحاجة
5. اضغط على "تكرار القسم الفرعي"

### من صفحة الأقسام الرئيسية:
1. انتقل إلى صفحة الأقسام الرئيسية
2. ابحث عن القسم الفرعي المطلوب في القائمة
3. اضغط على زر التكرار (أيقونة النسخ)
4. اتبع نفس الخطوات السابقة

## الملفات المضافة/المعدلة

### الملفات الجديدة:
- `resources/views/admin/sub_departments/duplicate.blade.php` - صفحة تكرار القسم الفرعي

### الملفات المعدلة:
- `app/Http/Controllers/Admin/SubDepartmentController.php` - إضافة دوال التكرار
- `resources/views/admin/sub_departments/index.blade.php` - إضافة زر التكرار
- `resources/views/admin/departments/index.blade.php` - إضافة زر التكرار
- `routes/web.php` - إضافة مسارات التكرار

## المسارات الجديدة:
- `GET /admin/sub_departments/{id}/duplicate` - عرض صفحة التكرار
- `POST /admin/sub_departments/{id}/duplicate` - معالجة عملية التكرار

## الميزات التقنية

### نسخ الحقول:
- يتم نسخ جميع الحقول المرتبطة بالقسم الفرعي الأصلي
- يتم إنشاء نسخ جديدة من الحقول مع ربطها بالقسم الفرعي الجديد
- يتم الحفاظ على جميع خصائص الحقول (النوع، الخيارات، الإعدادات)

### نسخ الصور:
- إذا تم رفع صورة جديدة، سيتم حفظها
- إذا لم يتم رفع صورة جديدة، سيتم نسخ الصورة الأصلية

### التحقق من الصحة:
- التحقق من صحة البيانات المدخلة
- التحقق من وجود القسم الفرعي الأصلي
- التحقق من صحة القسم الرئيسي المحدد

## ملاحظات مهمة:
- يتم إنشاء نسخة جديدة تماماً من القسم الفرعي
- لا يتم حذف القسم الفرعي الأصلي
- يمكن تعديل القسم الفرعي الجديد بعد إنشائه
- جميع الحقول المرتبطة يتم نسخها مع القسم الفرعي الجديد 
